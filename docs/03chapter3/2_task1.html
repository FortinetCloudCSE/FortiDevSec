<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.107.0">
    <meta name="generator" content="Relearn 5.12.6+tip">
    <meta name="description" content="Hugo web framework for Fortinet Demos">
    <meta name="author" content="Jeff Kopko">
    <title>Task 1 - Look at Vulnerabilities from the first scan  - Hugo web framework for Fortinet Demos</title>
    <link href="../03chapter3/2_task1/index.xml" rel="alternate" type="application/rss+xml" title="Task 1 - Look at Vulnerabilities from the first scan  - Hugo web framework for Fortinet Demos"><link rel="icon" href="https://www.fortinet.com/etc/designs/fortinet/favicon.ico" type="image/x-icon" />

    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="../css/fontawesome-all.min.css?1686164937" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../css/fontawesome-all.min.css?1686164937" rel="stylesheet"></noscript>
    <link href="../css/nucleus.css?1686164937" rel="stylesheet">
    <link href="../css/auto-complete.css?1686164937" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../css/auto-complete.css?1686164937" rel="stylesheet"></noscript>
    <link href="../css/perfect-scrollbar.min.css?1686164937" rel="stylesheet">
    <link href="../css/fonts.css?1686164937" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../css/fonts.css?1686164937" rel="stylesheet"></noscript>
    <link href="../css/theme.css?1686164937" rel="stylesheet">
    <link href="../css/theme-Fortinet.css?1686164937" rel="stylesheet" id="variant-style">
    <link href="../css/variant.css?1686164937" rel="stylesheet">
    <link href="../css/print.css?1686164937" rel="stylesheet" media="print">
    <link href="../css/ie.css?1686164937" rel="stylesheet">
    <script src="../js/url.js?1686164937"></script>
    <script src="../js/variant.js?1686164937"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_json_url="../index.json";
      window.index_js_url="../index.search.js";
      var root_url="../";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      window.T_No_results_found = 'No results found for \u0022{0}\u0022';
      window.T_N_results_found = '{1} results found for \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/fortinetcloudcse.github.io\/UserRepo/';
      window.variants && variants.init( [ 'Fortinet' ] );
    </script><style>
    @media screen and (min-width: 1300px) {

         
        #body .flex-block-wrapper {
            margin-left: auto;
            margin-right: auto;
            max-width: 1300px;
            width: 100%;
        }
    }
</style>
  </head>
  <body class="mobile-support html" data-url="../03chapter3/2_task1.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div class="navigation">
            <a class="nav nav-next topbar-link" href="../03chapter3/3_task2.html" title="Task 2 - Introduce a new vulnerability (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
            <a class="nav nav-prev topbar-link" href="../03chapter3.html" title="Ch 3 - Break stuff (and fix it) (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" class="topbar-link" title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../index.html"><span itemprop="name">GCP FortiDevSec TEC workshop</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../03chapter3.html"><span itemprop="name">Ch 3 - Break stuff (and fix it)</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Task 1 - Look at Vulnerabilities from the first scan </span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
<h1 id="task-1---look-at-vulnerabilities-from-the-first-scan">Task 1 - Look at Vulnerabilities from the first scan </h1>

<p>By clicking on the &ldquo;Vulnerabilities&rdquo; link in the IaC box, you can drill in to the issues found.  Note the filters on the left side of the screen and the sort functionality on the right.</p>
<p>
<a href="#image-59f9f56439ce48bb842e0c4454fb0f6c" class="lightbox-link">
<img src="../img/iac-det.png" alt="scan1" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-59f9f56439ce48bb842e0c4454fb0f6c">
<img src="../img/iac-det.png" alt="scan1" class="lightbox-image" loading="lazy">
</a></p>
<ol>
<li><strong>Let&rsquo;s dig into the vulnerability labeled as &ldquo;Firewall rule allows ingress traffic from multiple addresses on the public internet&rdquo; by clicking on it.  This will cause a pop up with more detail to appear on the right side of the screen.  From here we get more detail on the actual issue.  We can see that it was raised against main.tf, and that there are two occurrences of the error, and we are given the line numbers on which the errors can be found.</strong></li>
</ol>
<p>
<a href="#image-30932a1b9a402682a4fe9518354dc6fb" class="lightbox-link">
<img src="../img/quad0.png" alt="scan2" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-30932a1b9a402682a4fe9518354dc6fb">
<img src="../img/quad0.png" alt="scan2" class="lightbox-image" loading="lazy">
</a></p>
<ol>
<li><strong>We can go back to our Google cloud shell and open the file to fix the error, using the &ldquo;nano main.tf&rdquo; command.  With nano open, we can type ctrl+shift+- this will open a prompt at the bottom of the screen.   Type the line number from the vulnerability and hit enter.  This will move your cursor to the appropriate line (86).  We can see that this is a firewall rule applied to the untrust network, which is allowing all protocols from all IP sources (0.0.0.0/0).</strong></li>
</ol>
<p>
<a href="#image-a0d80f9a1ac79d849934f1930b4204e1" class="lightbox-link">
<img src="../img/nano-goto.png" alt="scan3" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-a0d80f9a1ac79d849934f1930b4204e1">
<img src="../img/nano-goto.png" alt="scan3" class="lightbox-image" loading="lazy">
</a></p>
<ol>
<li><strong>We have a couple of options.  We can either choose to accept the risk, or modify the code to limit the source IP addresses allowed.</strong></li>
</ol>
<p><strong>Accept risk:</strong></p>
<p>
<a href="#image-14cab1cf63767f418b956acb02ef2405" class="lightbox-link">
<img src="../img/acc-risk.png" alt="scan4" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-14cab1cf63767f418b956acb02ef2405">
<img src="../img/acc-risk.png" alt="scan4" class="lightbox-image" loading="lazy">
</a></p>
<p><strong>Modify Code:</strong>
Change line 86 so that &ldquo;source_ranges = [&ldquo;1.2.3.4/32&rdquo;]&rdquo;  Once don the firewall rule should look like below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Firewall Rule External</span>
</span></span><span class="line"><span class="cl">resource <span class="s2">&#34;google_compute_firewall&#34;</span> <span class="s2">&#34;allow-all-fgt&#34;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">name</span>    <span class="o">=</span> <span class="s2">&#34;allow-fgt-</span><span class="si">${</span><span class="nv">random_string</span><span class="p">.random_name_post.result</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">network</span> <span class="o">=</span> google_compute_network.untrust.name
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  allow <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">protocol</span> <span class="o">=</span> <span class="s2">&#34;all&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  allow <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">protocol</span> <span class="o">=</span> <span class="s2">&#34;icmp&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">source_ranges</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&#34;1.2.3.4/32&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="nv">target_tags</span>   <span class="o">=</span> <span class="o">[</span><span class="s2">&#34;allow-fgt&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><ol>
<li><strong>Now that we have made the modification, locally, we need to push it to our Github repository.  This will cause Github actions to deploy a docker host on ubuntu and run a scan against the application, ultimately reporting the results back to FortiDevSec.</strong></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">git status
</span></span><span class="line"><span class="cl">git add main.tf
</span></span><span class="line"><span class="cl">git commit -m <span class="s1">&#39;changed untrust gcp firewall rule to limit protocols&#39;</span>
</span></span><span class="line"><span class="cl">git push
</span></span></code></pre></div><p>The outputs should look something like this:</p>
<p>
<a href="#image-12cfb31e39373a142ae2886e762d7c18" class="lightbox-link">
<img src="../img/git-fix1.png" alt="scan5" style="height: auto; width: auto;" loading="lazy">
</a>
<a href="javascript:history.back();" class="lightbox" id="image-12cfb31e39373a142ae2886e762d7c18">
<img src="../img/git-fix1.png" alt="scan5" class="lightbox-image" loading="lazy">
</a></p>
<ol>
<li><strong>Once the scan is complete, go back to FortiDevSec and check that the number of vulnerabilities is reduced and that the &ldquo;Firewall rule allows ingress traffic from multiple addresses on the public internet&rdquo; vulnerability is no longer present.</strong></li>
</ol>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
<a id="logo" href='../' title="Fortinet Demos">
    <img style="vertical-align:middle" src="../Fortinet-logo-rgb-white-red.svg" height="70px">
    
        <style>
            logoBanner {
                font:  bold 40px Verdana, sans-serif;
                color: ;
                display: block;
                }
            logoBannerFreeForm {
                font: italic 20px Verdana, sans-serif;
                color: ;
                display: block;
                }
        </style>
        <logoBanner> Fortinet </logoBanner>
        <logoBannerFreeForm>  </logoBannerFreeForm>
    
</a>
        </div>
        <form action="../search.html" method="get"><div class="searchbox default-animation">
          <button type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
          <label class="a11y-only" for="search-by">Search</label>
          <input data-search-input id="search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div></form>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="../js/auto-complete.js?1686164937" defer></script>
        <script src="../js/lunr/lunr.min.js?1686164937" defer></script>
        <script src="../js/lunr/lunr.stemmer.support.min.js?1686164937" defer></script>
        <script src="../js/lunr/lunr.multi.min.js?1686164937" defer></script>
        <script src="../js/lunr/lunr.en.min.js?1686164937" defer></script>
        <script src="../js/search.js?1686164937" defer></script>
      </div>
      <div id="homelinks" class="default-animation">
        <ul>
          <li><a class="padding" href="../index.html"><i class="fas fa-home"></i> Home</a></li>
        </ul>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics enlarge morespace collapsible-menu">
          <li data-nav-id="/01gettingstarted.html" class=""><input type="checkbox" id="section-ed9604ea64d744c093d543113484d030" aria-controls="subsections-ed9604ea64d744c093d543113484d030"><label for="section-ed9604ea64d744c093d543113484d030"><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class="a11y-only">Submenu Get (git) Ready</span></label><a class="padding" href="../01gettingstarted.html">Get (git) Ready<i class="fas fa-check read-icon"></i></a><ul id="subsections-ed9604ea64d744c093d543113484d030" class="morespace collapsible-menu">
          <li data-nav-id="/01gettingstarted/2_task1.html" class=""><a class="padding" href="../01gettingstarted/2_task1.html">a: Token<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/01gettingstarted/3_task2.html" class=""><a class="padding" href="../01gettingstarted/3_task2.html">b: Fork<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/01gettingstarted/4_task3.html" class=""><a class="padding" href="../01gettingstarted/4_task3.html">c: Clone<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/02chapter2.html" class=""><input type="checkbox" id="section-62c2fe3114373324bebc69d927c3d721" aria-controls="subsections-62c2fe3114373324bebc69d927c3d721"><label for="section-62c2fe3114373324bebc69d927c3d721"><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class="a11y-only">Submenu Onboard Application</span></label><a class="padding" href="../02chapter2.html">Onboard Application<i class="fas fa-check read-icon"></i></a><ul id="subsections-62c2fe3114373324bebc69d927c3d721" class="morespace collapsible-menu">
          <li data-nav-id="/02chapter2/2_task1.html" class=""><a class="padding" href="../02chapter2/2_task1.html">a: Add-App<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/03chapter3.html" class="parent "><input type="checkbox" id="section-3b9afd005e5607fd2ea5f93bc999e00a" aria-controls="subsections-3b9afd005e5607fd2ea5f93bc999e00a" checked><label for="section-3b9afd005e5607fd2ea5f93bc999e00a"><i class="fas fa-chevron-down"></i><i class="fas fa-chevron-right"></i><span class="a11y-only">Submenu Break stuff (and fix it)</span></label><a class="padding" href="../03chapter3.html">Break stuff (and fix it)<i class="fas fa-check read-icon"></i></a><ul id="subsections-3b9afd005e5607fd2ea5f93bc999e00a" class="morespace collapsible-menu">
          <li data-nav-id="/03chapter3/2_task1.html" class="active"><a class="padding" href="../03chapter3/2_task1.html">a: Check Results<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/03chapter3/3_task2.html" class=""><a class="padding" href="../03chapter3/3_task2.html">b: New Vulnerability<i class="fas fa-check read-icon"></i></a></li></ul></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title padding">Helpful Resources</div>
          <ul class="space">
            <li><a class="padding" href="https://github.com/FortinetCloudCSE"><i class='fas fa-graduation-cap'></i> Fortinet Cloud CSE GitHub Org</a></li>
            <li><a class="padding" href="https://github.com/git/git/blob/master/Documentation/gittutorial.txt"><i class='fas fa-tools'></i>Github git tutorial</a></li>
            <li><a class="padding" href="https://docs.fortinet.com/document/fortidevsec/23.2.a/user-guide/546812/introduction"><i class='fas fa-tools'></i>FortiDevSec User Guide</a></li>
            <li><a class="padding" href="https://docs.fortinet.com/document/fortidast/23.2.0/user-guide/546812/introduction"><i class='fas fa-tools'></i> FortiDast User Guide</a></li>
            <li><a class="padding" href="https://cloud.google.com/shell/docs"><i class='fas fa-graduation-cap'></i> GCP Cloud Shell Documentation</a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div>
        <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter">
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch">
              <div class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-language">Language</label>
                  <select id="select-language" onchange="location = baseUri + this.value;">
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <div class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-variant">Theme</label>
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="Fortinet" value="Fortinet" selected>Fortinet</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><button class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i><span>&nbsp;</span>Clear History</button></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">          <style>
            #footer {
              font-size: .8125rem;
              height: 6.25rem;
              margin-left: auto;
              margin-right: auto;
              padding: 2rem 1rem;
              text-align: center;
              min-width: 14.375rem;
              max-width: 18.75rem;
            }
            #footer p {
              margin: 0;
            }
          </style>

<left>

    <a href="https://www.fortinet.com/corporate/about-us/privacy" target="_blank" rel="noreferrer noopener">Privacy</a> | <a
        href="https://www.fortinet.com/corporate/about-us/legal" target="_blank" rel="noreferrer noopener">Site Terms</a> | <a
        href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank" rel="noreferrer noopener">About Us</a>

</left>
        </div>
      </div>
    </aside>
    <script src="../js/clipboard.min.js?1686164937" defer></script>
    <script src="../js/perfect-scrollbar.min.js?1686164937" defer></script>
    <script src="../js/theme.js?1686164937" defer></script>
  </body>
</html>
